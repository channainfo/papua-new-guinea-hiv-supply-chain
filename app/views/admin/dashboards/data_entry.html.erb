<%=page_header("Dashboard Summary") %>
<%=simple_form_for :order , :url => admin_root_path, :method => 'GET', :html => {:id => 'search_order'} do |f| %>
	<div class='row-fluid control-inline'>
		<div class='span1'></div>
	    <div class='span4' id='search_start_date'>
	      <%= f.input :start_date, :as => 'date_time_picker', 
	                               :label => 'Form summition date' ,
	                               :label_html => {:class=> 'inline'},
	                               :input_html => {:class => 'datepicker-fit date-field', :value => params[:start], :name => 'start'}
	                               %>   
	    </div>

	    <div class='span2' id='search_end_date'>
	        <%= f.input :end_date, :as => 'date_time_picker', 
	                                      :label => 'To',
	                                      :label_html => { :class => 'inline'},
	                                      :input_html => { :class  => 'datepicker-fit date-field', :value => params[:end], :name => 'end' } 
	                                      %> 
	    </div>
	    <div class='span5'></div>
	  </div> 
<% end %>
<ul class='dashboard-item-set'>
 <%
  [
  	{ :quantity => @total_order_by_status[Order::ORDER_STATUS_TO_BE_REVISED].to_i,  :class => :order_pending, 
  		:type => Order::ORDER_STATUS_TO_BE_REVISED,   :text => 'Orders reviewed and rejected. Pending for you to revise'},
  	{ :quantity => @total_order_by_status[Order::ORDER_STATUS_PENDING].to_i, :class => :order_submitted,  
  		:type => Order::ORDER_STATUS_PENDING, :text => 'New orders submitted from site for you to review and make order suggestion'},
  	{ :quantity => @total_order_by_status[Order::ORDER_STATUS_APPROVED].to_i, :class => :order_approved,  
  		:type => Order::ORDER_STATUS_APPROVED,  :text => 'Orders approved' },
  	{ :quantity => @total_order_by_status[Order::ORDER_STATUS_TO_BE_REVIEWED].to_i , :class => :order_in_review, 
  		:type => Order::ORDER_STATUS_TO_BE_REVIEWED, :text => 'Orders in review'},

  ].each do |order| %>
  	<li> 
  		<div>
			 <a href='<%= admin_orders_path(:type => order[:type]) %>' >
			 	<span class='order_size <%=order[:class] %>' > <%= order[:quantity] %> </span>
			 	<span > <%= order[:text] %> </span>
			 </a>			 
  		</div>
  	</li>	

<% end %>
</ul>
<script>
  function handleDateField(){
    $(".date-field").on('change', function(){
      $items  =	$(".date-field")
      var hasData = true
      for(var i=0; i< $items.length; i++){
      	 if( $.trim($items.get(i).value) == "" ){
      	 	hasData = false ;
      	 	break;
      	 }
      }
      if(hasData){
      	$("#search_order").submit();
      }

    });

  } 

  $(function(){
 	  handleDateField();
  });

</script>